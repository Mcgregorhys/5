{% extends 'base.html.twig' %}

{% block title %}Lista produktów{% endblock %}

{% block body %}
<div class="bg-blue-500 text-white p-4 text-center">Moja testowa aplikacja</div>



<div class="px-30 ... bg-blue-00">
 
<form method="post" action="{{ path('product_edit_or_delete') }}" enctype="multipart/form-data">
<style>
 
</style>

<button class="btn btn-outline-primary"><a href={{ path('product_new')}}>Dodaj</a></button> 
<button class="btn btn-outline-primary"><a href="{{ path('app_category_new') }}" >Dodaj nową kategorię</a> </button>
<button class="btn btn-outline-primary"><a href="{{ path('add-category') }}" >Przypisz nową kategorię</a> </button>
<button class="btn btn-outline-primary"><a href={{ path('product_discounts')}}>Upusty</a></button> 
<button class="btn btn-outline-primary"><a href={{ path('product_param')}}>Parametry</a></button>
<div class="table-container">
    <table class="responsive-table">
    <thead>
        <tr>
            <th class="w-auto">ID</th>
            <th class="w-auto">Lp</th>
            <th class="w-auto">Kod</th>
            <th class="w-auto">Zdjecie</th>
            <th class="w-auto">Dodaj zdjęcie</th>
            <th class="w-auto">Usuń zdjęcie</th>
            <th class="min-w-[200px]">Nazwa produktu</th>
            <th class="w-auto">Ilość</th>
            <th class="w-auto">Cena netto</th>
            <th class="w-auto">VAT (%)</th>
            <th class="w-auto">Cena brutto</th>
            <th class="w-auto">Wartość</th>
          
            <th class="w-auto">Usuń</th>
        </tr>
    </thead>
    <tbody>
        {% for product in products %}
        <tr>
            <td class="border-4 border-double border-blue-400 p-2">{{ product.id}}</td>
            <td class="border-4 border-double border-blue-400 p-2">{{ loop.index }}</td>
            <td class="border-4 border-double border-blue-400 p-2 w-full md:w-auto">
                <input type="text" name="products[{{ product.id }}][kod]" value="{{ product.kod }}" class="auto-input">
            <td class="p-2">
                {% if product.imageFilename %}
                    <img src="{{ asset('uploads/products/' ~ product.imageFilename) }}" alt="zdjęcie" class="max-w-[100px]">
                {% else %}
                    brak
                {% endif %}
            </td>
            <td class="p-2">
                {% if not product.imageFilename %}
                    <input type="file" name="product_images[{{ product.id }}]" class="auto-input">
                {% endif %}
            </td>
            <td class="p-2">
                {% if product.imageFilename %}
                    <input type="checkbox" name="remove_image[]" value="{{ product.id }}" class="auto-input">
                {% endif %}
            </td>
           <td class="border-4 border-double border-blue-400 p-2 align-top max-w-[200px]">
                <input type="text" name="products[{{ product.id }}][nazwaProduktu]" value="{{ product.nazwaProduktu }}" class="auto-input">
            </td>
            <td class="border-4 border-double border-blue-400 p-2">
                <input type="number" step="1"  name="products[{{ product.id }}][amount]" value="{{ product.amount }}" class="auto-input">           
            </td>
            <td class="border-4 border-double border-blue-400 p-2">
                <input type="number" step="0,01" name="products[{{ product.id }}][cenaNetto]" value="{{ product.cenaNetto }}" class="auto-input">
            </td>
            <td class="border-4 border-double border-blue-400 p-2">
                <input type="number" step="1" name="products[{{ product.id }}][vat]" value="{{ product.vat }}"class="auto-input">
            </td>
            <td class="border-4 border-double border-blue-400 p-2 w-full min-w-[100px]">
                {{ (product.cenaNetto + (product.cenaNetto * product.vat / 100))|number_format(2, '.', ',') }}
            </td>
            <td class="border-4 border-double border-blue-400 p-2">
                {{ ((product.cenaNetto + (product.cenaNetto * product.vat / 100)) * product.amount)|number_format(2, '.', ',') }}
            </td>
           
            <td class="border-4 border-double border-blue-400 p-2">
                    <input type="checkbox" name="to_delete[]" value="{{ product.id }}" class="auto-input[readonly]">
            </td>   
           
       
            
        </tr>
               
            {% else %}
            
                <tr>
                    <td colspan="6">Brak produktów w bazie danych.</td>
                </tr>
            {% endfor %}
         
        </tbody>
           
    </table>   
    </div>                                       
<div class="btn btn-primary btn-lg btn-block  text-center"> 
        <tr class="bg-blue-500" >
            <td  colspan="3">Wartość produktów brutto:</td>
            <!-- colspan powinien być równy liczbie kolumn minus 1 -->
            <td>{{ totalValue|number_format(2, ',', ' ') }} zł</td>
        </tr>
        </div>
    <button type="submit" name="action" value="update" class="button">Zapisz zmiany</button>
    <button type="submit" name="action" value="delete" class="button">Usuń zaznaczone</button>
    
    
</form>
</div>
{% endblock %}
